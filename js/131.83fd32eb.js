"use strict";(self["webpackChunkSonuto"]=self["webpackChunkSonuto"]||[]).push([[131],{69493:function(e,t,o){o.r(t),o.d(t,{default:function(){return be}});var l=o(59835),i=function(e){return(0,l.dD)("data-v-1159bbdb"),e=e(),(0,l.Cn)(),e},s={class:"main-container"},n={class:"profile-edit-section"},r={class:"row"},a={class:"col"},c={class:"row user-section"},u={class:"col"},d={class:"user-name"},m={class:"row user-section"},g={class:"col"},p={key:0,class:"user-name"},f={key:1,class:"user-name"},h={class:"row"},v={class:"col"},b=["accept"],y={key:0,class:"banner-image"},w={key:1,class:"banner-image"},k=["innerHTML"],C={key:1},V={style:{"margin-top":"1rem"}},D=i((function(){return(0,l._)("div",{class:"text-h6 col-md-6"},[(0,l._)("b",null,"Updated")],-1)})),_={class:"text-h6 col-md-6 close"},B={class:"row"},P={class:"text-h6 col",style:{"text-align":"center"}},x={key:0},F={key:1},W={class:"flex flex-center more-info-item"},I={class:"row items-center no-wrap",style:{"margin-bottom":"30px"}},S={class:"col"},M={class:"text-h6"},q={key:0},U={key:1},Z={class:"col-12"},L={key:0},T={key:1},Q={class:"col-12 text-center"},$={class:"row"},A={class:"col-6 text-center"},R={class:"col-6 text-center"};function H(e,t,o,i,H,O){var j=(0,l.up)("q-input"),E=(0,l.up)("q-select"),K=(0,l.up)("q-img"),N=(0,l.up)("q-video"),Y=(0,l.up)("q-btn"),z=(0,l.up)("q-icon"),G=(0,l.up)("q-form"),J=(0,l.up)("BlogAction"),X=(0,l.up)("q-dialog"),ee=(0,l.up)("BlogSuccessMessage"),te=(0,l.up)("q-space"),oe=(0,l.up)("q-card-section"),le=(0,l.up)("q-card"),ie=(0,l.up)("q-page"),se=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(ie,{class:"flex-center",style:{"background-color":"white"}},{default:(0,l.w5)((function(){return[(0,l._)("div",s,[(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("div",a,[(0,l.Wm)(G,{class:"q-gutter-md"},{default:(0,l.w5)((function(){return[(0,l._)("div",c,[(0,l._)("div",u,[(0,l._)("span",d,[(0,l.Wm)(j,{modelValue:H.form.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return H.form.title=e}),label:"Title","stack-label":""},null,8,["modelValue"])]),(0,l.Wm)(E,{modelValue:H.form.categories,"onUpdate:modelValue":t[1]||(t[1]=function(e){return H.form.categories=e}),options:e.blogCategory,"emit-value":"","map-options":"",label:"Category",multiple:"",class:"q-my-md","option-value":function(e){return e.id},"option-label":function(e){return e.Name}},null,8,["modelValue","options","option-value","option-label"]),(0,l._)("div",m,[(0,l._)("div",g,[H.form.isForVlog?((0,l.wg)(),(0,l.iD)("span",p," Video ")):((0,l.wg)(),(0,l.iD)("span",f," Cover photo/video ")),(0,l._)("div",h,[(0,l._)("div",v,[null!=H.form.coverPhoto?((0,l.wg)(),(0,l.j4)(K,{key:0,src:"".concat(H.form.coverPhoto),"spinner-color":"white",style:{"max-height":"280px","max-width":"100%"}},null,8,["src"])):(0,l.kq)("",!0),null!=H.form.coverVideo?((0,l.wg)(),(0,l.j4)(N,{key:1,src:"".concat(H.form.coverVideo),style:{height:"220px",width:"100%"}},null,8,["src"])):(0,l.kq)("",!0),(0,l._)("div",{style:{"max-width":"100%",height:"46px",padding:"5px 5px",border:"1px #6B7BC7 dotted","text-align":"center"},class:"fileupload",onClick:t[3]||(t[3]=function(t){return e.$refs.file.click()})},[(0,l._)("input",{type:"file",ref:"file",style:{display:"none"},onChange:t[2]||(t[2]=function(){return O.onFileChange&&O.onFileChange.apply(O,arguments)}),accept:[H.form.isForVlog?"video/*":"image/*"]},null,40,b),(0,l.Wm)(Y,{class:"img-icon",icon:"app:upload-img",flat:"",round:"",dense:""}),H.form.isForVlog?((0,l.wg)(),(0,l.iD)("span",y," Upload Video")):((0,l.wg)(),(0,l.iD)("span",w," Upload Image "))])])])])]),H.form.content?((0,l.wg)(),(0,l.iD)("div",{key:0,innerHTML:H.form.content,class:"content",onClick:t[4]||(t[4]=function(){return O.startCreatePost&&O.startCreatePost.apply(O,arguments)})},null,8,k)):((0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",V,[(0,l.Wm)(Y,{outline:"",style:{height:"70px",width:"100% !important"},align:"left","no-caps":"",onClick:O.startCreatePost,label:"Start creating your post..."},null,8,["onClick"])])])),H.form.isForVlog?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(E,{key:2,label:"Labels",modelValue:H.form.label,"onUpdate:modelValue":t[5]||(t[5]=function(e){return H.form.label=e}),"use-input":"","use-chips":"",multiple:"",options:H.allKeywords,style:{width:"100% !important"}},{append:(0,l.w5)((function(){return[(0,l.Wm)(z,{name:"app:question-mark"})]})),_:1},8,["modelValue","options"]))])])]})),_:1})])])]),(0,l.Wm)(X,{modelValue:H.saveDraftDialog,"onUpdate:modelValue":t[6]||(t[6]=function(e){return H.saveDraftDialog=e}),position:"bottom"},{default:(0,l.w5)((function(){return[(0,l.Wm)(J,{isForVlog:H.form.isForVlog,onClickedSelectedOption:O.clickedSelectedOptionModal},null,8,["isForVlog","onClickedSelectedOption"])]})),_:1},8,["modelValue"])]),(0,l.Wm)(X,{modelValue:H.successfulModal,"onUpdate:modelValue":t[7]||(t[7]=function(e){return H.successfulModal=e})},{default:(0,l.w5)((function(){return[(0,l.Wm)(ee,{messageType:H.blogMessageType,isVlog:H.form.isForVlog},null,8,["messageType","isVlog"])]})),_:1},8,["modelValue"]),(0,l.Wm)(X,{modelValue:H.updateModal,"onUpdate:modelValue":t[8]||(t[8]=function(e){return H.updateModal=e})},{default:(0,l.w5)((function(){return[(0,l.Wm)(le,{class:"popup"},{default:(0,l.w5)((function(){return[(0,l.Wm)(oe,{class:"row items-center q-pb-none"},{default:(0,l.w5)((function(){return[D,(0,l.Wm)(te),(0,l._)("div",_,[(0,l.wy)((0,l.Wm)(Y,{icon:"close",onClick:O.gotoblgArticleList,flat:"",round:"",dense:""},null,8,["onClick"]),[[se]])])]})),_:1}),(0,l._)("div",B,[(0,l._)("div",P,[(0,l.Wm)(z,{name:"app:successful",class:"success col-md-12"})])]),(0,l.Wm)(oe,{class:"success-msg"},{default:(0,l.w5)((function(){return[(0,l._)("p",null,[(0,l.Uk)(" Your "),H.form.isForVlog?((0,l.wg)(),(0,l.iD)("span",x,"Vlog")):((0,l.wg)(),(0,l.iD)("span",F,"Blog")),(0,l.Uk)(" has been updated successfully. ")])]})),_:1}),(0,l._)("div",W,[(0,l.Wm)(Y,{color:"primary",onClick:O.gotoblgArticleList,label:"Done",rounded:"","no-caps":""},null,8,["onClick"])])]})),_:1})]})),_:1},8,["modelValue"]),(0,l.Wm)(X,{modelValue:H.blogDeleteModel,"onUpdate:modelValue":t[11]||(t[11]=function(e){return H.blogDeleteModel=e}),position:"bottom"},{default:(0,l.w5)((function(){return[(0,l.Wm)(le,{class:"roundedNewsFeed"},{default:(0,l.w5)((function(){return[(0,l._)("div",I,[(0,l._)("div",S,[(0,l.Wm)(oe,{class:"row items-center q-pb-none"},{default:(0,l.w5)((function(){return[(0,l._)("div",M,[(0,l.Uk)("Delete "),!0===H.form.isForVlog?((0,l.wg)(),(0,l.iD)("span",q,"Vlog")):((0,l.wg)(),(0,l.iD)("span",U,"Blog"))]),(0,l.Wm)(te),(0,l.wy)((0,l.Wm)(Y,{icon:"close",flat:"",round:"",dense:""},null,512),[[se]])]})),_:1}),(0,l.Wm)(oe,{class:"row items-center q-pb-none"},{default:(0,l.w5)((function(){return[(0,l._)("p",Z,[(0,l.Uk)(" Are you sure you want to delete this "),!0===H.form.isForVlog?((0,l.wg)(),(0,l.iD)("span",L,"vlog")):((0,l.wg)(),(0,l.iD)("span",T,"blog")),(0,l.Uk)("? ")])]})),_:1}),(0,l._)("div",Q,[(0,l._)("div",$,[(0,l._)("div",A,[(0,l.Wm)(Y,{label:"Cancel",class:"button default-button","no-caps":"",outline:"",color:"primary",style:{color:"#000000",width:"90%"},onClick:t[9]||(t[9]=function(e){return O.deleteConfirmationChoice("cancel")})})]),(0,l._)("div",R,[(0,l.Wm)(Y,{color:"primary",style:{width:"90%"},label:"Confirm",class:"button default-button","no-caps":"",onClick:t[10]||(t[10]=function(e){return O.deleteConfirmationChoice("confirm")})})])])])])])]})),_:1})]})),_:1},8,["modelValue"])]})),_:1})}var O=o(47798),j=o.n(O),E=o(1001),K=o.n(E),N=o(46264),Y=o.n(N),z=(o(58665),o(46727),o(3452),o(69665),o(98998),o(65716),o(77280),o(40702),o(84641),o(83269),o(22725),o(59437),o(33100)),G=o(6827),J=o(56404),X=o(27643),ee={name:"CreatePost",data:function(){return{form:{id:0,title:"",content:"",label:null,coverPhoto:null,coverVideo:null,isForVlog:!1,categories:[]},blogCoverPhoto:null,blogMessageType:"Published",successfulModal:!1,saveDraftDialog:!1,allKeywords:[],updateModal:!1,blogDeleteModel:!1,posterImage:null}},components:{BlogSuccessMessage:J.Z,BlogAction:X.Z},created:function(){this.$emitter.on("headerRightIcon1Click",this.openSaveDialog),this.$emitter.on("headerBackButtonClick",this.backButtonClick)},beforeUnmount:function(){this.$emitter.off("headerRightIcon1Click",this.openSaveDialog),this.$emitter.off("headerBackButtonClick",this.backButtonClick)},computed:Y()(Y()({},(0,z.Se)("userprofile",["userDetails"])),(0,z.Se)("blog",["blog","blogs","CreateBlog","keywords","blogCategory"])),mounted:function(){var e,t,o,l,i=this;!0===(null===(e=this.$route)||void 0===e||null===(t=e.query)||void 0===t?void 0:t.isForVlog)&&(this.form.isForVlog=!0),this.setHeaderData(!1,!0,null!==(o=this.$route)&&void 0!==o&&null!==(l=o.query)&&void 0!==l&&l.isForVlog?"Create Vlog":"Create Blog","three-dots-icon",!1,"",!1,!1),this.fetchKeywords().then((function(){i.allKeywords=i.keywords,i.filterOptions=i.keywords})),null!==this.CreateBlog&&(this.form=Object.assign({},this.CreateBlog),this.blogCoverPhoto=this.CreateBlog.blogCoverPhoto,this.posterImage=this.CreateBlog.posterImage),this.fetchBlogCategory()},methods:Y()(Y()(Y()({},(0,z.nv)("blog",["postBlog","storeContent","fetchKeywords","fetchBlogCategory","PutBlog","deleteBlog"])),(0,z.nv)("header",["setHeader"])),{},{setHeaderData:function(e,t,o,l,i,s,n,r){this.setHeader({hamburgerIcon:e,backIcon:t,title:o,rightIcon1:l,rightIcon2:i,rightLinkText:s,notificationIcon:n,searchIcon:r})},saveBlog:function(e){var t=this;this.form.isForVlog&&null===this.form.coverVideo&&"Submitted"===e?G.Z.create({progress:!0,message:"Please Upload Video",type:"negative"}):""!==this.form.title||"Submitted"!==e?this.form.isForVlog||null!==this.form.coverPhoto||"Submitted"!==e?0!==this.form.categories.length||"Submitted"!==e?(e||(e="Submitted"),this.blogMessageType=e,this.form.categories.includes(1)||this.form.categories.push(1),0===parseInt(this.form.id)?this.postBlog({user:this.userDetails.userprofile.id,form:this.form,status:e,file:this.blogCoverPhoto,poster:this.posterImage}).then((function(e){t.successfulModal=!0})):this.PutBlog({user:this.userDetails.userprofile.id,form:this.form,file:this.blogCoverPhoto,status:e,poster:this.posterImage}).then((function(e){t.updateModal=!0}))):G.Z.create({progress:!0,message:"Please select at least one category",type:"negative"}):G.Z.create({progress:!0,message:"Please Add Cover Photo",type:"negative"}):G.Z.create({progress:!0,message:"Please Add Title",type:"negative"})},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&(this.blogCoverPhoto=t[0],"image"===t[0].type.split("/")[0]?(this.createImage(t[0]),this.form.coverVideo=null):(this.validateVideoFile(t[0]),this.form.coverPhoto=null))},createImage:function(e){var t=this,o=new FileReader;o.onload=function(e){t.form.coverPhoto=e.target.result},o.readAsDataURL(e)},createVideo:function(e){var t=URL.createObjectURL(e);this.form.coverVideo=t},openSaveDialog:function(){this.saveDraftDialog=!0},action:function(e){this.$emit("clicked-selected-Option",e)},clickedSelectedOptionModal:function(e){switch(e){case"Edit":this.startCreatePost();break;case"Submit":this.saveBlog("Submitted");break;case"Draft":this.saveBlog("Drafts");break;case"Delete":this.blogDeleteModel=!0;break;case"Discard":this.saveDraftDialog=!1,this.form.id=0,this.form.title="",this.form.content="",this.form.label=null,this.form.coverPhoto=null,this.form.coverVideo=null,this.blogCoverPhoto=null;break}},backButtonClick:function(){this.$router.push("dashboard")},startCreatePost:function(){var e=this;this.storeContent({form:this.form,file:this.blogCoverPhoto,poster:this.posterImage}).then((function(){e.$router.push("create-post-detail")}))},validateVideoFile:function(e){var t=this,o=document.createElement("video");o.preload="metadata",o.onloadedmetadata=function(){parseInt(o.duration.toString().split(".")[0])<301?(t.form.coverVideo=o.src,t.createThumbnail()):(t.blogCoverPhoto=null,G.Z.create({progress:!0,message:"Video Should be less than 5 mints",type:"negative"}))},o.src=URL.createObjectURL(e)},createThumbnail:function(){var e=this;return K()(j()().mark((function t(){var o,l;return j()().wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=new FileReader,o.readAsDataURL(e.blogCoverPhoto),l=function(t){t&&(e.posterImage=t)},o.onloadend=K()(j()().mark((function e(){var t,i,s,n,r,a,c;return j()().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.result,i=document.createElement("video"),s=document.createElement("canvas"),i.style.display="none",s.style.display="none",e.next=7,new Promise((function(e,o){i.addEventListener("loadedmetadata",(function(){i.width=i.videoWidth,i.height=i.videoHeight,s.width=i.videoWidth,s.height=i.videoHeight,i.currentTime=.25*i.duration})),i.addEventListener("seeked",(function(){return e()})),i.src=t}));case 7:return s.getContext("2d").drawImage(i,0,0,i.videoWidth,i.videoHeight),n=s.toDataURL("image/png"),e.next=11,fetch(n);case 11:return r=e.sent,e.next=14,r.blob();case 14:a=e.sent,c=new File([a],"poster",{type:"image/png"}),this.posterImage=c,l(c);case 18:case"end":return e.stop()}}),e,this)})));case 4:case"end":return t.stop()}}),t)})))()},gotoblgArticleList:function(){this.form.isForVlog?this.$router.push({name:"blog-articles",params:{tab:this.blogMessageType},query:{isForVlog:"true"}}):this.$router.push({name:"blog-articles",params:{tab:this.blogMessageType}})},deleteConfirmationChoice:function(e){var t=this;"confirm"===e?this.deleteBlog(parseInt(this.form.id)).then((function(){t.blogDeleteModel=!1,G.Z.create({progress:!0,message:"Blog Deleted Successfully",type:"positive"}),t.gotoblgArticleList()})):this.blogDeleteModel=!1}})},te=o(11639),oe=o(69885),le=o(8326),ie=o(13119),se=o(32259),ne=o(91487),re=o(31005),ae=o(68879),ce=o(22857),ue=o(32074),de=o(44458),me=o(63190),ge=o(90136),pe=o(62146),fe=o(69984),he=o.n(fe);const ve=(0,te.Z)(ee,[["render",H],["__scopeId","data-v-1159bbdb"]]);var be=ve;he()(ee,"components",{QPage:oe.Z,QForm:le.Z,QInput:ie.Z,QSelect:se.Z,QImg:ne.Z,QVideo:re.Z,QBtn:ae.Z,QIcon:ce.Z,QDialog:ue.Z,QCard:de.Z,QCardSection:me.Z,QSpace:ge.Z}),he()(ee,"directives",{ClosePopup:pe.Z})}}]);